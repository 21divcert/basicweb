{"ast":null,"code":"// import logo from './logo.svg';\n// import './App.css';\n\n// function App() {\n//   return (\n//     <div className=\"App\">\n//       <header className=\"App-header\">\n//         <img src={logo} className=\"App-logo\" alt=\"logo\" />\n//         <p>\n//           Edit <code>src/App.js</code> and save to reload.\n//         </p>\n//         <a\n//           className=\"App-link\"\n//           href=\"https://reactjs.org\"\n//           target=\"_blank\"\n//           rel=\"noopener noreferrer\"\n//         >\n//           Learn React\n//         </a>\n\n//       </header>\n//     </div>\n//   );\n// }\n\n// export default App;\n\n// @ts-check\nclass EventEmitter {\n  constructor() {\n    this.listeners = {};\n  }\n  on(message, listener) {\n    if (!this.listeners[message]) {\n      this.listeners[message] = [];\n    }\n    this.listeners[message].push(listener);\n  }\n  emit(message, payload = null) {\n    if (this.listeners[message]) {\n      this.listeners[message].forEach(l => l(message, payload));\n    }\n  }\n}\nclass GameObject {\n  constructor(x, y) {\n    this.x = x;\n    this.y = y;\n    this.dead = false;\n    this.type = '';\n    this.width = 0;\n    this.height = 0;\n    this.img = undefined;\n  }\n  draw(ctx) {\n    ctx.drawImage(this.img, this.x, this.y, this.width, this.height);\n  }\n  rectFromGameObject() {\n    return {\n      top: this.y,\n      left: this.x,\n      bottom: this.y + this.height,\n      right: this.x + this.width\n    };\n  }\n}\nclass Hero extends GameObject {\n  constructor(x, y) {\n    super(x, y);\n    this.width = 99, this.height = 75;\n    this.type = 'Hero';\n    this.speed = {\n      x: 0,\n      y: 0\n    };\n  }\n}\nclass Laser extends GameObject {\n  constructor(x, y) {\n    super(x, y);\n    this.width = 9;\n    this.height = 33;\n    this.type = 'Laser';\n    let id = setInterval(() => {\n      if (!this.dead) {\n        this.y = this.y > 0 ? this.y - 20 : this.y;\n        if (this.y <= 0) {\n          this.dead = true;\n        }\n      } else {\n        clearInterval(id);\n      }\n    }, 100);\n  }\n}\nclass Explosion extends GameObject {\n  constructor(x, y, img) {\n    super(x, y);\n    this.img = img;\n    this.type = 'Explosion';\n    this.width = 56 * 2, this.height = 54 * 2;\n    setTimeout(() => {\n      this.dead = true;\n    }, 300);\n  }\n}\nclass Monster extends GameObject {\n  constructor(x, y) {\n    super(x, y);\n    this.type = 'Monster';\n    this.width = 98, this.height = 50;\n    let id = setInterval(() => {\n      if (!this.dead) {\n        this.y = this.y < HEIGHT ? this.y + 30 : this.y;\n        if (this.y >= HEIGHT - this.height) {\n          this.dead = true;\n          eventEmitter.emit('MONSTER_OUT_OF_BOUNDS');\n        }\n      } else {\n        clearInterval(id);\n      }\n    }, 1500);\n  }\n}\nconst Messages = {\n  MONSTER_OUT_OF_BOUNDS: 'MONSTER_OUT_OF_BOUNDS',\n  HERO_SPEED_LEFT: 'HERO_MOVING_LEFT',\n  HERO_SPEED_RIGHT: 'HERO_MOVING_RIGHT',\n  HERO_SPEED_ZERO: 'HERO_SPEED_ZERO',\n  HERO_FIRE: 'HERO_FIRE',\n  GAME_END_LOSS: 'GAME_END_LOSS',\n  GAME_END_WIN: 'GAME_END_WIN',\n  COLLISION_MONSTER_LASER: 'COLLISION_MONSTER_LASER',\n  COLLISION_MONSTER_HERO: 'COLLISION_MONSTER_HERO',\n  KEY_EVENT_UP: 'KEY_EVENT_UP',\n  KEY_EVENT_DOWN: 'KEY_EVENT_DOWN',\n  KEY_EVENT_LEFT: 'KEY_EVENT_LEFT',\n  KEY_EVENT_RIGHT: 'KEY_EVENT_RIGHT',\n  GAME_START: 'GAME_START'\n};\nclass Game {\n  constructor() {\n    this.points = 0;\n    this.life = 3;\n    this.end = false;\n    this.ready = false;\n    eventEmitter.on(Messages.MONSTER_OUT_OF_BOUNDS, () => {\n      hero.dead = true;\n    });\n    eventEmitter.on(Messages.HERO_SPEED_LEFT, () => {\n      hero.speed.x = -10;\n      hero.img = heroImgLeft;\n    });\n    eventEmitter.on(Messages.HERO_SPEED_RIGHT, () => {\n      hero.speed.x = 10;\n      hero.img = heroImgRight;\n    });\n    eventEmitter.on(Messages.HERO_SPEED_ZERO, () => {\n      hero.speed = {\n        x: 0,\n        y: 0\n      };\n      if (game.life === 3) {\n        hero.img = heroImg;\n      } else {\n        hero.img = heroImgDamaged;\n      }\n    });\n    eventEmitter.on(Messages.HERO_FIRE, () => {\n      if (coolDown === 0) {\n        let l = new Laser(hero.x + 45, hero.y - 30);\n        l.img = laserRedImg;\n        gameObjects.push(l);\n        cooling();\n      }\n    });\n    eventEmitter.on(Messages.GAME_END_LOSS, (_, gameLoopId) => {\n      game.end = true;\n      displayMessage('You died... - Press [Enter] to start the game Captain Pew Pew');\n      clearInterval(gameLoopId);\n    });\n    eventEmitter.on(Messages.GAME_END_WIN, (_, gameLoopId) => {\n      game.end = true;\n      displayMessage('Victory!!! Pew Pew... - Press [Enter] to start a new game Captain Pew Pew', 'green');\n      clearInterval(gameLoopId);\n    });\n    eventEmitter.on(Messages.COLLISION_MONSTER_LASER, (_, {\n      first: laser,\n      second: monster\n    }) => {\n      laser.dead = true;\n      monster.dead = true;\n      this.points += 100;\n      gameObjects.push(new Explosion(monster.x, monster.y, laserRedShot));\n    });\n    eventEmitter.on(Messages.COLLISION_MONSTER_HERO, (_, {\n      monster: m,\n      id\n    }) => {\n      game.life--;\n      if (game.life === 0) {\n        hero.dead = true;\n        eventEmitter.emit(Messages.GAME_END_LOSS, id);\n        gameObjects.push(new Explosion(hero.x, hero.y, laserGreenShot));\n      }\n      hero.img = heroImgDamaged;\n      m.dead = true;\n      gameObjects.push(new Explosion(m.x, m.y, laserRedShot));\n    });\n    eventEmitter.on(Messages.KEY_EVENT_UP, () => {\n      hero.y = hero.y > 0 ? hero.y - 5 : hero.y;\n    });\n    eventEmitter.on(Messages.KEY_EVENT_DOWN, () => {\n      hero.y = hero.y < HEIGHT ? hero.y + 5 : hero.y;\n    });\n    eventEmitter.on(Messages.KEY_EVENT_LEFT, () => {\n      hero.x = hero.x > 0 ? hero.x - 10 : hero.x;\n    });\n    eventEmitter.on(Messages.KEY_EVENT_RIGHT, () => {\n      hero.x = hero.x < WIDTH ? hero.x + 10 : hero.x;\n    });\n    eventEmitter.on(Messages.GAME_START, () => {\n      if (game.ready && game.end) {\n        // assets loaded\n        runGame();\n      }\n    });\n  }\n}\nconst eventEmitter = new EventEmitter();\nconst hero = new Hero(0, 0);\nconst WIDTH = 1024;\nconst HEIGHT = 768;\nlet gameObjects = [];\nlet laserRedImg;\nlet laserRedShot;\nlet laserGreenShot;\nlet canvas;\nlet ctx;\nlet heroImg;\nlet heroImgLeft;\nlet heroImgRight;\nlet heroImgDamaged;\nlet lifeImg;\nlet monsterImg;\nlet coolDown = 0;\nconst game = new Game();\nfunction loadTexture(path) {\n  return new Promise(resolve => {\n    const img = new Image();\n    img.src = path;\n    img.onload = () => {\n      resolve(img);\n    };\n  });\n}\nfunction rectFromGameObject(go) {\n  return {\n    top: go.y,\n    left: go.x,\n    bottom: go.y + go.height,\n    right: go.x + go.width\n  };\n}\nfunction intersectRect(r1, r2) {\n  return !(r2.left > r1.right || r2.right < r1.left || r2.top > r1.bottom || r2.bottom < r1.top);\n}\nfunction draw(ctx, objects) {\n  objects.forEach(obj => {\n    obj.draw(ctx);\n  });\n}\nlet onKeyDown = function (e) {\n  console.log(e.keyCode);\n  switch (e.keyCode) {\n    case 37:\n    case 39:\n    case 38:\n    case 40: // Arrow keys\n    case 32:\n      e.preventDefault();\n      break;\n    // Space\n    default:\n      break;\n    // do not block other keys\n  }\n};\nwindow.addEventListener('keydown', onKeyDown);\nwindow.addEventListener('keydown', e => {\n  switch (e.keyCode) {\n    case 37:\n      // if left\n      eventEmitter.emit(Messages.HERO_SPEED_LEFT);\n      break;\n    case 39:\n      eventEmitter.emit(Messages.HERO_SPEED_RIGHT);\n      break;\n  }\n});\n\n// TODO make message driven\nwindow.addEventListener('keyup', evt => {\n  eventEmitter.emit(Messages.HERO_SPEED_ZERO);\n  if (evt.key === 'ArrowUp') {\n    eventEmitter.emit(Messages.KEY_EVENT_UP);\n  } else if (evt.key === 'ArrowDown') {\n    eventEmitter.emit(Messages.KEY_EVENT_DOWN);\n  } else if (evt.key === 'ArrowLeft') {\n    eventEmitter.emit(Messages.KEY_EVENT_LEFT);\n  } else if (evt.key === 'ArrowRight') {\n    eventEmitter.emit(Messages.KEY_EVENT_RIGHT);\n  } else if (evt.keyCode === 32) {\n    // space\n    eventEmitter.emit(Messages.HERO_FIRE);\n  } else if (evt.key === 'Enter') {\n    eventEmitter.emit(Messages.GAME_START);\n  }\n});\nfunction cooling() {\n  coolDown = 500;\n  let id = setInterval(() => {\n    coolDown -= 100;\n    if (coolDown === 0) {\n      clearInterval(id);\n    }\n  }, 100);\n}\nfunction displayGameScore(message) {\n  ctx.font = '30px Arial';\n  ctx.fillStyle = 'red';\n  ctx.textAlign = 'right';\n  ctx.fillText(message, canvas.width - 90, canvas.height - 30);\n}\nfunction displayLife() {\n  // should show tree ships.. 94 * 3\n  const START_X = canvas.width - 150 - 30;\n  for (let i = 0; i < game.life; i++) {\n    ctx.drawImage(lifeImg, START_X + (i + 1) * 35, canvas.height - 90);\n  }\n}\nfunction displayMessage(message, color = 'red') {\n  ctx.font = '30px Arial';\n  ctx.fillStyle = color;\n  ctx.textAlign = 'center';\n  ctx.fillText(message, canvas.width / 2, canvas.height / 2);\n}\nfunction createMonsters(monsterImg) {\n  // 98 * 5     canvas.width - (98*5 /2)\n  const MONSTER_TOTAL = 5;\n  const MONSTER_WIDTH = MONSTER_TOTAL * 98;\n  const START_X = (canvas.width - MONSTER_WIDTH) / 2;\n  const STOP_X = START_X + MONSTER_WIDTH;\n  for (let x = START_X; x < STOP_X; x += 98) {\n    for (let y = 0; y < 50 * 5; y += 50) {\n      gameObjects.push(new Monster(x, y));\n    }\n  }\n  gameObjects.forEach(go => {\n    go.img = monsterImg;\n  });\n}\nfunction createHero(heroImg) {\n  hero.dead = false;\n  hero.img = heroImg;\n  hero.y = canvas.height / 4 * 3;\n  hero.x = canvas.width / 2;\n  gameObjects.push(hero);\n}\nfunction checkGameState(gameLoopId) {\n  const monsters = gameObjects.filter(go => go.type === 'Monster');\n  if (hero.dead) {\n    eventEmitter.emit(Messages.GAME_END_LOSS, gameLoopId);\n  } else if (monsters.length === 0) {\n    eventEmitter.emit(Messages.GAME_END_WIN);\n  }\n\n  // update hero position\n  if (hero.speed.x !== 0) {\n    hero.x += hero.speed.x;\n  }\n  const lasers = gameObjects.filter(go => go.type === 'Laser');\n  // laser hit something\n  lasers.forEach(l => {\n    monsters.forEach(m => {\n      if (intersectRect(l.rectFromGameObject(), m.rectFromGameObject())) {\n        eventEmitter.emit(Messages.COLLISION_MONSTER_LASER, {\n          first: l,\n          second: m\n        });\n      }\n    });\n  });\n\n  // hero hit monster\n  monsters.forEach(m => {\n    if (intersectRect(m.rectFromGameObject(), hero.rectFromGameObject())) {\n      eventEmitter.emit(Messages.COLLISION_MONSTER_HERO, {\n        monster: m,\n        id: gameLoopId\n      });\n    }\n  });\n  gameObjects = gameObjects.filter(go => !go.dead);\n}\nfunction runGame() {\n  gameObjects = [];\n  game.life = 3;\n  game.points = 0;\n  game.end = false;\n  createMonsters(monsterImg);\n  createHero(heroImg);\n  let gameLoopId = setInterval(() => {\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n    ctx.fillStyle = 'black';\n    ctx.fillRect(0, 0, canvas.width, canvas.height);\n    displayGameScore('Score: ' + game.points);\n    displayLife();\n    checkGameState(gameLoopId);\n    draw(ctx, gameObjects);\n  }, 100);\n}\nwindow.onload = async () => {\n  canvas = document.getElementById('myCanvas');\n  ctx = canvas.getContext('2d');\n  heroImg = await loadTexture('spaceArt/png/player.png');\n  heroImgLeft = await loadTexture('spaceArt/png/playerLeft.png');\n  heroImgRight = await loadTexture('spaceArt/png/playerRight.png');\n  heroImgDamaged = await loadTexture('spaceArt/png/playerDamaged.png');\n  monsterImg = await loadTexture('spaceArt/png/enemyShip.png');\n  laserRedImg = await loadTexture('spaceArt/png/laserRed.png');\n  laserRedShot = await loadTexture('spaceArt/png/laserRedShot.png');\n  laserGreenShot = await loadTexture('spaceArt/png/laserGreenShot.png');\n  lifeImg = await loadTexture('spaceArt/png/life.png');\n  game.ready = true;\n  game.end = true;\n  ctx.clearRect(0, 0, canvas.width, canvas.height);\n  ctx.fillStyle = 'black';\n  ctx.fillRect(0, 0, canvas.width, canvas.height);\n  displayMessage('Press [Enter] to start the game Captain Pew Pew', 'blue');\n\n  // CHECK  draw 5 * 5 monsters\n  // CHECK move monsters down 1 step per 0.5 second\n  // CHECK if monster collide with hero, destroy both, display loose text\n  // CHECK if monster reach MAX, destroy hero, loose text\n  // TODO add explosion when laser hits monster, should render for <=300ms\n  // TODO add specific texture when moving left or right\n  // TODO take damage when a meteor moves into you\n  // TODO add meteor, meteors can damage ships\n  // TODO add UFO after all monsters are down, UFO can fire back\n  // TODO start random green laser from an enemy and have it go to HEIGHT, if collide with hero then deduct point\n\n  // CHECK  draw bullet\n  // CHECK , bullet should be destroyed at top\n  // CHECK space should produce bullet, bullet should move 2 step per second\n  // CHECK if bullet collide with monster, destroy both\n  // CHECK if bullet rect intersect with monster rect then it is colliding..\n};","map":{"version":3,"names":["EventEmitter","constructor","listeners","on","message","listener","push","emit","payload","forEach","l","GameObject","x","y","dead","type","width","height","img","undefined","draw","ctx","drawImage","rectFromGameObject","top","left","bottom","right","Hero","speed","Laser","id","setInterval","clearInterval","Explosion","setTimeout","Monster","HEIGHT","eventEmitter","Messages","MONSTER_OUT_OF_BOUNDS","HERO_SPEED_LEFT","HERO_SPEED_RIGHT","HERO_SPEED_ZERO","HERO_FIRE","GAME_END_LOSS","GAME_END_WIN","COLLISION_MONSTER_LASER","COLLISION_MONSTER_HERO","KEY_EVENT_UP","KEY_EVENT_DOWN","KEY_EVENT_LEFT","KEY_EVENT_RIGHT","GAME_START","Game","points","life","end","ready","hero","heroImgLeft","heroImgRight","game","heroImg","heroImgDamaged","coolDown","laserRedImg","gameObjects","cooling","_","gameLoopId","displayMessage","first","laser","second","monster","laserRedShot","m","laserGreenShot","WIDTH","runGame","canvas","lifeImg","monsterImg","loadTexture","path","Promise","resolve","Image","src","onload","go","intersectRect","r1","r2","objects","obj","onKeyDown","e","console","log","keyCode","preventDefault","window","addEventListener","evt","key","displayGameScore","font","fillStyle","textAlign","fillText","displayLife","START_X","i","color","createMonsters","MONSTER_TOTAL","MONSTER_WIDTH","STOP_X","createHero","checkGameState","monsters","filter","length","lasers","clearRect","fillRect","document","getElementById","getContext"],"sources":["C:/KangMinJeong/2021108207/src/App.js"],"sourcesContent":["// import logo from './logo.svg';\n// import './App.css';\n\n// function App() {\n//   return (\n//     <div className=\"App\">\n//       <header className=\"App-header\">\n//         <img src={logo} className=\"App-logo\" alt=\"logo\" />\n//         <p>\n//           Edit <code>src/App.js</code> and save to reload.\n//         </p>\n//         <a\n//           className=\"App-link\"\n//           href=\"https://reactjs.org\"\n//           target=\"_blank\"\n//           rel=\"noopener noreferrer\"\n//         >\n//           Learn React\n//         </a>\n\n        \n//       </header>\n//     </div>\n//   );\n// }\n\n// export default App;\n\n// @ts-check\nclass EventEmitter {\n\tconstructor() {\n\t\tthis.listeners = {};\n\t}\n\n\ton(message, listener) {\n\t\tif (!this.listeners[message]) {\n\t\t\tthis.listeners[message] = [];\n\t\t}\n\t\tthis.listeners[message].push(listener);\n\t}\n\n\temit(message, payload = null) {\n\t\tif (this.listeners[message]) {\n\t\t\tthis.listeners[message].forEach((l) => l(message, payload));\n\t\t}\n\t}\n}\n\nclass GameObject {\n\tconstructor(x, y) {\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.dead = false;\n\t\tthis.type = '';\n\t\tthis.width = 0;\n\t\tthis.height = 0;\n\t\tthis.img = undefined;\n\t}\n\n\tdraw(ctx) {\n\t\tctx.drawImage(this.img, this.x, this.y, this.width, this.height);\n\t}\n\n\trectFromGameObject() {\n\t\treturn {\n\t\t\ttop: this.y,\n\t\t\tleft: this.x,\n\t\t\tbottom: this.y + this.height,\n\t\t\tright: this.x + this.width,\n\t\t};\n\t}\n}\n\nclass Hero extends GameObject {\n\tconstructor(x, y) {\n\t\tsuper(x, y);\n\t\t(this.width = 99), (this.height = 75);\n\t\tthis.type = 'Hero';\n\t\tthis.speed = { x: 0, y: 0 };\n\t}\n}\n\nclass Laser extends GameObject {\n\tconstructor(x, y) {\n\t\tsuper(x, y);\n\t\tthis.width = 9;\n\t\tthis.height = 33;\n\t\tthis.type = 'Laser';\n\t\tlet id = setInterval(() => {\n\t\t\tif (!this.dead) {\n\t\t\t\tthis.y = this.y > 0 ? this.y - 20 : this.y;\n\t\t\t\tif (this.y <= 0) {\n\t\t\t\t\tthis.dead = true;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tclearInterval(id);\n\t\t\t}\n\t\t}, 100);\n\t}\n}\n\nclass Explosion extends GameObject {\n\tconstructor(x, y, img) {\n\t\tsuper(x, y);\n\t\tthis.img = img;\n\t\tthis.type = 'Explosion';\n\t\t(this.width = 56 * 2), (this.height = 54 * 2);\n\t\tsetTimeout(() => {\n\t\t\tthis.dead = true;\n\t\t}, 300);\n\t}\n}\n\nclass Monster extends GameObject {\n\tconstructor(x, y) {\n\t\tsuper(x, y);\n\t\tthis.type = 'Monster';\n\t\t(this.width = 98), (this.height = 50);\n\t\tlet id = setInterval(() => {\n\t\t\tif (!this.dead) {\n\t\t\t\tthis.y = this.y < HEIGHT ? this.y + 30 : this.y;\n\t\t\t\tif (this.y >= HEIGHT - this.height) {\n\t\t\t\t\tthis.dead = true;\n\t\t\t\t\teventEmitter.emit('MONSTER_OUT_OF_BOUNDS');\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tclearInterval(id);\n\t\t\t}\n\t\t}, 1500);\n\t}\n}\n\nconst Messages = {\n\tMONSTER_OUT_OF_BOUNDS: 'MONSTER_OUT_OF_BOUNDS',\n\tHERO_SPEED_LEFT: 'HERO_MOVING_LEFT',\n\tHERO_SPEED_RIGHT: 'HERO_MOVING_RIGHT',\n\tHERO_SPEED_ZERO: 'HERO_SPEED_ZERO',\n\tHERO_FIRE: 'HERO_FIRE',\n\tGAME_END_LOSS: 'GAME_END_LOSS',\n\tGAME_END_WIN: 'GAME_END_WIN',\n\tCOLLISION_MONSTER_LASER: 'COLLISION_MONSTER_LASER',\n\tCOLLISION_MONSTER_HERO: 'COLLISION_MONSTER_HERO',\n\tKEY_EVENT_UP: 'KEY_EVENT_UP',\n\tKEY_EVENT_DOWN: 'KEY_EVENT_DOWN',\n\tKEY_EVENT_LEFT: 'KEY_EVENT_LEFT',\n\tKEY_EVENT_RIGHT: 'KEY_EVENT_RIGHT',\n\tGAME_START: 'GAME_START',\n};\n\nclass Game {\n\tconstructor() {\n\t\tthis.points = 0;\n\t\tthis.life = 3;\n\t\tthis.end = false;\n\t\tthis.ready = false;\n\n\t\teventEmitter.on(Messages.MONSTER_OUT_OF_BOUNDS, () => {\n\t\t\thero.dead = true;\n\t\t});\n\t\teventEmitter.on(Messages.HERO_SPEED_LEFT, () => {\n\t\t\thero.speed.x = -10;\n\t\t\thero.img = heroImgLeft;\n\t\t});\n\t\teventEmitter.on(Messages.HERO_SPEED_RIGHT, () => {\n\t\t\thero.speed.x = 10;\n\t\t\thero.img = heroImgRight;\n\t\t});\n\t\teventEmitter.on(Messages.HERO_SPEED_ZERO, () => {\n\t\t\thero.speed = { x: 0, y: 0 };\n\t\t\tif (game.life === 3) {\n\t\t\t\thero.img = heroImg;\n\t\t\t} else {\n\t\t\t\thero.img = heroImgDamaged;\n\t\t\t}\n\t\t});\n\t\teventEmitter.on(Messages.HERO_FIRE, () => {\n\t\t\tif (coolDown === 0) {\n\t\t\t\tlet l = new Laser(hero.x + 45, hero.y - 30);\n\t\t\t\tl.img = laserRedImg;\n\t\t\t\tgameObjects.push(l);\n\t\t\t\tcooling();\n\t\t\t}\n\t\t});\n\t\teventEmitter.on(Messages.GAME_END_LOSS, (_, gameLoopId) => {\n\t\t\tgame.end = true;\n\t\t\tdisplayMessage('You died... - Press [Enter] to start the game Captain Pew Pew');\n\t\t\tclearInterval(gameLoopId);\n\t\t});\n\n\t\teventEmitter.on(Messages.GAME_END_WIN, (_, gameLoopId) => {\n\t\t\tgame.end = true;\n\t\t\tdisplayMessage('Victory!!! Pew Pew... - Press [Enter] to start a new game Captain Pew Pew', 'green');\n\t\t\tclearInterval(gameLoopId);\n\t\t});\n\t\teventEmitter.on(Messages.COLLISION_MONSTER_LASER, (_, { first: laser, second: monster }) => {\n\t\t\tlaser.dead = true;\n\t\t\tmonster.dead = true;\n\t\t\tthis.points += 100;\n\n\t\t\tgameObjects.push(new Explosion(monster.x, monster.y, laserRedShot));\n\t\t});\n\t\teventEmitter.on(Messages.COLLISION_MONSTER_HERO, (_, { monster: m, id }) => {\n\t\t\tgame.life--;\n\t\t\tif (game.life === 0) {\n\t\t\t\thero.dead = true;\n\t\t\t\teventEmitter.emit(Messages.GAME_END_LOSS, id);\n\t\t\t\tgameObjects.push(new Explosion(hero.x, hero.y, laserGreenShot));\n\t\t\t}\n\t\t\thero.img = heroImgDamaged;\n\t\t\tm.dead = true;\n\t\t\tgameObjects.push(new Explosion(m.x, m.y, laserRedShot));\n\t\t});\n\t\teventEmitter.on(Messages.KEY_EVENT_UP, () => {\n\t\t\thero.y = hero.y > 0 ? hero.y - 5 : hero.y;\n\t\t});\n\t\teventEmitter.on(Messages.KEY_EVENT_DOWN, () => {\n\t\t\thero.y = hero.y < HEIGHT ? hero.y + 5 : hero.y;\n\t\t});\n\t\teventEmitter.on(Messages.KEY_EVENT_LEFT, () => {\n\t\t\thero.x = hero.x > 0 ? hero.x - 10 : hero.x;\n\t\t});\n\t\teventEmitter.on(Messages.KEY_EVENT_RIGHT, () => {\n\t\t\thero.x = hero.x < WIDTH ? hero.x + 10 : hero.x;\n\t\t});\n\t\teventEmitter.on(Messages.GAME_START, () => {\n\t\t\tif (game.ready && game.end) {\n\t\t\t\t// assets loaded\n\t\t\t\trunGame();\n\t\t\t}\n\t\t});\n\t}\n}\n\nconst eventEmitter = new EventEmitter();\nconst hero = new Hero(0, 0);\nconst WIDTH = 1024;\nconst HEIGHT = 768;\nlet gameObjects = [];\nlet laserRedImg;\nlet laserRedShot;\nlet laserGreenShot;\nlet canvas;\nlet ctx;\nlet heroImg;\nlet heroImgLeft;\nlet heroImgRight;\nlet heroImgDamaged;\nlet lifeImg;\nlet monsterImg;\n\nlet coolDown = 0;\n\nconst game = new Game();\n\nfunction loadTexture(path) {\n\treturn new Promise((resolve) => {\n\t\tconst img = new Image();\n\t\timg.src = path;\n\t\timg.onload = () => {\n\t\t\tresolve(img);\n\t\t};\n\t});\n}\n\nfunction rectFromGameObject(go) {\n\treturn {\n\t\ttop: go.y,\n\t\tleft: go.x,\n\t\tbottom: go.y + go.height,\n\t\tright: go.x + go.width,\n\t};\n}\n\nfunction intersectRect(r1, r2) {\n\treturn !(r2.left > r1.right || r2.right < r1.left || r2.top > r1.bottom || r2.bottom < r1.top);\n}\n\nfunction draw(ctx, objects) {\n\tobjects.forEach((obj) => {\n\t\tobj.draw(ctx);\n\t});\n}\n\nlet onKeyDown = function (e) {\n\tconsole.log(e.keyCode);\n\tswitch (e.keyCode) {\n\t\tcase 37:\n\t\tcase 39:\n\t\tcase 38:\n\t\tcase 40: // Arrow keys\n\t\tcase 32:\n\t\t\te.preventDefault();\n\t\t\tbreak; // Space\n\t\tdefault:\n\t\t\tbreak; // do not block other keys\n\t}\n};\n\nwindow.addEventListener('keydown', onKeyDown);\nwindow.addEventListener('keydown', (e) => {\n\tswitch (e.keyCode) {\n\t\tcase 37:\n\t\t\t// if left\n\t\t\teventEmitter.emit(Messages.HERO_SPEED_LEFT);\n\t\t\tbreak;\n\t\tcase 39:\n\t\t\teventEmitter.emit(Messages.HERO_SPEED_RIGHT);\n\t\t\tbreak;\n\t}\n});\n\n// TODO make message driven\nwindow.addEventListener('keyup', (evt) => {\n\teventEmitter.emit(Messages.HERO_SPEED_ZERO);\n\tif (evt.key === 'ArrowUp') {\n\t\teventEmitter.emit(Messages.KEY_EVENT_UP);\n\t} else if (evt.key === 'ArrowDown') {\n\t\teventEmitter.emit(Messages.KEY_EVENT_DOWN);\n\t} else if (evt.key === 'ArrowLeft') {\n\t\teventEmitter.emit(Messages.KEY_EVENT_LEFT);\n\t} else if (evt.key === 'ArrowRight') {\n\t\teventEmitter.emit(Messages.KEY_EVENT_RIGHT);\n\t} else if (evt.keyCode === 32) {\n\t\t// space\n\t\teventEmitter.emit(Messages.HERO_FIRE);\n\t} else if (evt.key === 'Enter') {\n\t\teventEmitter.emit(Messages.GAME_START);\n\t}\n});\n\nfunction cooling() {\n\tcoolDown = 500;\n\tlet id = setInterval(() => {\n\t\tcoolDown -= 100;\n\t\tif (coolDown === 0) {\n\t\t\tclearInterval(id);\n\t\t}\n\t}, 100);\n}\n\nfunction displayGameScore(message) {\n\tctx.font = '30px Arial';\n\tctx.fillStyle = 'red';\n\tctx.textAlign = 'right';\n\tctx.fillText(message, canvas.width - 90, canvas.height - 30);\n}\n\nfunction displayLife() {\n\t// should show tree ships.. 94 * 3\n\tconst START_X = canvas.width - 150 - 30;\n\tfor (let i = 0; i < game.life; i++) {\n\t\tctx.drawImage(lifeImg, START_X + (i + 1) * 35, canvas.height - 90);\n\t}\n}\n\nfunction displayMessage(message, color = 'red') {\n\tctx.font = '30px Arial';\n\tctx.fillStyle = color;\n\tctx.textAlign = 'center';\n\tctx.fillText(message, canvas.width / 2, canvas.height / 2);\n}\n\nfunction createMonsters(monsterImg) {\n\t// 98 * 5     canvas.width - (98*5 /2)\n\tconst MONSTER_TOTAL = 5;\n\tconst MONSTER_WIDTH = MONSTER_TOTAL * 98;\n\tconst START_X = (canvas.width - MONSTER_WIDTH) / 2;\n\tconst STOP_X = START_X + MONSTER_WIDTH;\n\n\tfor (let x = START_X; x < STOP_X; x += 98) {\n\t\tfor (let y = 0; y < 50 * 5; y += 50) {\n\t\t\tgameObjects.push(new Monster(x, y));\n\t\t}\n\t}\n\n\tgameObjects.forEach((go) => {\n\t\tgo.img = monsterImg;\n\t});\n}\n\nfunction createHero(heroImg) {\n\thero.dead = false;\n\thero.img = heroImg;\n\thero.y = (canvas.height / 4) * 3;\n\thero.x = canvas.width / 2;\n\tgameObjects.push(hero);\n}\n\nfunction checkGameState(gameLoopId) {\n\tconst monsters = gameObjects.filter((go) => go.type === 'Monster');\n\tif (hero.dead) {\n\t\teventEmitter.emit(Messages.GAME_END_LOSS, gameLoopId);\n\t} else if (monsters.length === 0) {\n\t\teventEmitter.emit(Messages.GAME_END_WIN);\n\t}\n\n\t// update hero position\n\tif (hero.speed.x !== 0) {\n\t\thero.x += hero.speed.x;\n\t}\n\n\tconst lasers = gameObjects.filter((go) => go.type === 'Laser');\n\t// laser hit something\n\tlasers.forEach((l) => {\n\t\tmonsters.forEach((m) => {\n\t\t\tif (intersectRect(l.rectFromGameObject(), m.rectFromGameObject())) {\n\t\t\t\teventEmitter.emit(Messages.COLLISION_MONSTER_LASER, {\n\t\t\t\t\tfirst: l,\n\t\t\t\t\tsecond: m,\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t});\n\n\t// hero hit monster\n\tmonsters.forEach((m) => {\n\t\tif (intersectRect(m.rectFromGameObject(), hero.rectFromGameObject())) {\n\t\t\teventEmitter.emit(Messages.COLLISION_MONSTER_HERO, { monster: m, id: gameLoopId });\n\t\t}\n\t});\n\n\tgameObjects = gameObjects.filter((go) => !go.dead);\n}\n\nfunction runGame() {\n\tgameObjects = [];\n\tgame.life = 3;\n\tgame.points = 0;\n\tgame.end = false;\n\n\tcreateMonsters(monsterImg);\n\tcreateHero(heroImg);\n\n\tlet gameLoopId = setInterval(() => {\n\t\tctx.clearRect(0, 0, canvas.width, canvas.height);\n\t\tctx.fillStyle = 'black';\n\t\tctx.fillRect(0, 0, canvas.width, canvas.height);\n\t\tdisplayGameScore('Score: ' + game.points);\n\t\tdisplayLife();\n\t\tcheckGameState(gameLoopId);\n\t\tdraw(ctx, gameObjects);\n\t}, 100);\n}\n\nwindow.onload = async () => {\n\tcanvas = document.getElementById('myCanvas');\n\tctx = canvas.getContext('2d');\n\n\theroImg = await loadTexture('spaceArt/png/player.png');\n\theroImgLeft = await loadTexture('spaceArt/png/playerLeft.png');\n\theroImgRight = await loadTexture('spaceArt/png/playerRight.png');\n\theroImgDamaged = await loadTexture('spaceArt/png/playerDamaged.png');\n\tmonsterImg = await loadTexture('spaceArt/png/enemyShip.png');\n\tlaserRedImg = await loadTexture('spaceArt/png/laserRed.png');\n\tlaserRedShot = await loadTexture('spaceArt/png/laserRedShot.png');\n\tlaserGreenShot = await loadTexture('spaceArt/png/laserGreenShot.png');\n\tlifeImg = await loadTexture('spaceArt/png/life.png');\n\n\tgame.ready = true;\n\tgame.end = true;\n\tctx.clearRect(0, 0, canvas.width, canvas.height);\n\tctx.fillStyle = 'black';\n\tctx.fillRect(0, 0, canvas.width, canvas.height);\n\tdisplayMessage('Press [Enter] to start the game Captain Pew Pew', 'blue');\n\n\t// CHECK  draw 5 * 5 monsters\n\t// CHECK move monsters down 1 step per 0.5 second\n\t// CHECK if monster collide with hero, destroy both, display loose text\n\t// CHECK if monster reach MAX, destroy hero, loose text\n\t// TODO add explosion when laser hits monster, should render for <=300ms\n\t// TODO add specific texture when moving left or right\n\t// TODO take damage when a meteor moves into you\n\t// TODO add meteor, meteors can damage ships\n\t// TODO add UFO after all monsters are down, UFO can fire back\n\t// TODO start random green laser from an enemy and have it go to HEIGHT, if collide with hero then deduct point\n\n\t// CHECK  draw bullet\n\t// CHECK , bullet should be destroyed at top\n\t// CHECK space should produce bullet, bullet should move 2 step per second\n\t// CHECK if bullet collide with monster, destroy both\n\t// CHECK if bullet rect intersect with monster rect then it is colliding..\n};"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}